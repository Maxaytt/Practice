@model Domain.ViewModel.QuestionVm

@{
    ViewBag.Title = "Add Question";
}

<div class="container">
    <h2>Add Question</h2>
    <form asp-action="AddQuestion" asp-controller="Films" method="post">
        <input type="hidden" name="FilmId" value="@Model.FilmId" />

        <div class="form-group">
            <label>Question Text</label>
            <input type="text" name="Text" value="@Model.Text" class="form-control" />
        </div>

        <h3>Answers</h3>

        @for (int i = 0; i < Model.Answers.Count; i++)
        {
            <div class="form-group">
                <label>Answer @(i + 1)</label>
                <input type="text" name="Answers[@i].Text" value="@Model.Answers[i].Text" class="form-control" />
                <input type="checkbox" name="Answers[@i].IsTrue" value="true" @(Model.Answers[i].IsTrue ? "checked" : "") class="correct-answer-checkbox" /> Correct
            </div>
        }

        <button type="submit" class="btn btn-primary">Save Question</button>
    </form>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const checkboxes = document.querySelectorAll('.correct-answer-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function () {
                    if (this.checked) {
                        checkboxes.forEach(cb => {
                            if (cb !== this) {
                                cb.checked = false;
                            }
                        });
                    }
                });
            });
        });
    </script>
}
